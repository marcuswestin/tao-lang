set unstable := true
set fallback := true
# set quiet := true

_pretest:
    just gen

test *PATTERNS: _pretest
    bun test --reporter=dot --test-name-pattern "{{ PATTERNS }}"

watch-test *PATTERNS:
    bun test . --watch --reporter=dot --test-name-pattern "{{ PATTERNS }}"

build:
    bun install
    just gen
    bunx tsc

gen:
    bunx langium generate --mode=development
    just q-dev gen-syntax-tmLanguage-files

watch-compiler:
    bun -e "import 'compiler-src/compiler-main'; console.log('Reload...'); " --watch --no-clear-screen

watch-grammar:
    watchexec --restart --watch=tao-grammar.langium -- just gen
